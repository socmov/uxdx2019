<!DOCTYPE html>
<html lang="en">
  <head>
    <title>{% if page.title %}{{ page.title }} – {% endif %}{{ site.name }} – {{ site.description }}</title>

    {% include scripts/meta.html %}

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <script defer src="https://use.fontawesome.com/releases/v5.0.2/js/all.js"></script>
    <link rel="stylesheet" type="text/css" href='https://css.tito.io/v1.1' />
    <link rel="shortcut icon" type="image/x-icon" href="{{ site.baseurl }}/favicon.ico?">
    <link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/style.css?{{site.time | date: '%s%N'}}" />
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
    <link rel="alternate" type="application/rss+xml" title="{{ site.name }} - {{ site.description }}" href="{{ site.baseurl }}/feed.xml" />

    <script src="{{ site.baseurl }}/assets/js/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>

    <script type="application/javascript">

      function getConfDetails() {

        const today_date = Date.now()
        const super_early = new Date(2018, 5, 1, 12, 00)
        const early = new Date(2018, 5, 29, 12, 00)
        const regular1 = new Date(2018, 6, 6, 23, 59, 59)
        const regular3 = new Date(2018, 6, 20, 23, 59, 59)
        const regular5 = new Date(2018, 7, 3, 23, 59, 59)
        const regular7 = new Date(2018, 7, 17, 23, 59, 59)
        const regular9 = new Date(2018, 7, 31, 23, 59, 59)
        const regular11 = new Date(2018, 8, 14, 23, 59, 59)
        const regular13 = new Date(2018, 8, 28, 23, 59, 59)
        const late = new Date(2018, 9, 5, 23, 59, 59)

        let expiry, confRelease, confTrainingRelease, confPrice, confTrainingPrice
        let expired = false
        if (today_date < super_early) {
          expiry = super_early
        }

        else if (today_date < early) {
          expiry = early
        }
        else if (today_date < regular1) {
          expiry = regular1
          confRelease = 'ydglcmzkk-y'
          confTrainingRelease = 'dxpcv7huse4'
          confPrice = 545
          confTrainingPrice = 850
        }
        else if (today_date < regular3) {
          expiry = regular3
          confRelease = 'fc1wxhrkn-q'
          confTrainingRelease = 'zna8bzjxsai'
          confPrice = 565
          confTrainingPrice = 890
        }
        else if (today_date < regular5) {
          expiry = regular5
          confRelease = 'x52ipwhxeho'
          confTrainingRelease = 'nqbyokejscq'
          confPrice = 590
          confTrainingPrice = 930

        }
        else if (today_date < regular7) {
          expiry = regular7
          confRelease = 'fhqs8uaztts'
          confTrainingRelease = 'hotm-ixkssu'
          confPrice = 660
          confTrainingPrice = '1,050'

        }
        else if (today_date < regular9) {
          expiry = regular9
          confRelease = 'vyiswgcnhte'
          confTrainingRelease = 'blb8sfmp6wo'
          confPrice = 690
          confTrainingPrice = '1,100'

        }
        else if (today_date < regular11) {
          expiry = regular11
          confRelease = 'r-hmndiwfty'
          confTrainingRelease = 'xb-dbsahsge'
          confPrice = 735
          confTrainingPrice = '1,180'

        }
        else if (today_date < regular13) {
          expiry = regular13
          confRelease = 'gfl4k6pt7ya'
          confTrainingRelease = 'nvxicfratku'
          confPrice = 770
          confTrainingPrice = '1,250'

        }
        else if (today_date < late) {
          expiry = late
          confRelease = 'dzyxl6pbu7y'
          confTrainingRelease = 'o4e81imuxsy'
          confPrice = 850
          confTrainingPrice = '1,375'

        }
        else expired = true

        return {
          expiry,
          confRelease,
          confTrainingRelease,
          confPrice,
          confTrainingPrice
        }
      }


      // get the expiry time
      let details = getConfDetails();

      window.onload = function () {
        console.log(details);

        var conferencePrice = document.getElementById("conference-price");
        conferencePrice.innerHTML = "€" + details.confPrice;

        var conferenceRelease = document.getElementById("conference-release");
        conferenceRelease.setAttribute("releases", details.confRelease);

        var conferenceTrainingPrice = document.getElementById("conference-training-price");
        conferenceTrainingPrice.innerHTML = "€" + details.confTrainingPrice;

        var conferenceTrainingRelease = document.getElementById("conference-training-release");
        conferenceTrainingRelease.setAttribute("releases", details.confTrainingRelease);
      }


    </script>
    <script src='https://js.tito.io/v1' async></script>
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
      w[l] = w[l] || []; w[l].push({
        'gtm.start':
          new Date().getTime(), event: 'gtm.js'      
}); var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
          'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
      })(window, document, 'script', 'dataLayer', 'GTM-M9MJLPW');</script>
    <!-- End Google Tag Manager -->
  </head>

  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
      <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M9MJLPW" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div class="alert alert-info" role="alert">
      Prices increase in {% include components/countdown.html %} <strong><a href="{{ site.baseurl }}/tickets">Book now</a></strong>
    </div>

    <nav class="navbar navbar-expand-md navbar-dark fixed-top">
      <a href="{{ site.baseurl }}/" class="navbar-brand">
        <img src="{{ site.baseurl }}/images/UXDX-White-NoLogoText-NoText.svg"  width="30" height="30" alt="UXDX Conf 2018"/>
      </a>
      
      <a class="navbar-brand" href="{{ site.baseurl }}/">UXDX Conf 2018</a>

      {% assign conference = site.data.conferences | where: "id", page.conference %} 
      {% assign conference = conference[0] %}
      
      {% if conference.primary_menu[0].pages___buttons.size > 0 %}
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#uxdxNav" aria-controls="uxdxNav"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      {% else %}
        <div></div>
      {% endif %}

    
      <div class="collapse navbar-collapse" id="uxdxNav">
        <ul class="navbar-nav ml-auto">
          {% for page in conference.primary_menu[0].pages___buttons %}
          <li class="nav-item">
            {% if page.url_slug == 'tickets' %}
            <a class="btn btn-outline-light" href="{{ site.baseurl }}/{{page.url_slug}}">{{page.url_slug | capitalize}}</a>
            {% elsif page.url_slug %}
              {% if page.menu_title.size > 0 %}
                {% assign title = page.menu_title %}
              {% else %}
               {% assign title = page.url_slug | capitalize %}
              {% endif %}
              <a class="nav-link" href="{{ site.baseurl }}/{{page.url_slug}}">{{title}}</a>
            {% else %}
              <tito-button event="{{conference.tito_event}}" releases="{{page.tito_release}}">{{button.button_text}}</tito-button>
            {% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>
    </nav>
    
    <main role="main">
      {{ content }}
    </main>

    {% include components/footer.html %}


    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="{{ site.baseurl }}/assets/js/bootstrap.min.js"></script>
    {% include scripts/video-script.html %}
    {% include scripts/agenda_toggle.html %}
    
    <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase-messaging.js"></script>
    <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyAP8fPFW7OFw1Da05Geiev5fIZfkdAZL8A",
        authDomain: "uxdxconf.firebaseapp.com",
        databaseURL: "https://uxdxconf.firebaseio.com",
        projectId: "uxdxconf",
        storageBucket: "uxdxconf.appspot.com",
        messagingSenderId: "576147997259"
      };
      firebase.initializeApp(config);
    </script>
    <script src="{{ site.baseurl }}/assets/js/auth.js"></script>
    
    <script type="text/javascript">

      // (1)
      if (navigator.serviceWorker) {
        navigator.serviceWorker.register('/service-worker.js').then(function (reg) {
          if (!reg.installing) return;
          console.log("[*] ServiceWorker is installing...");

          var worker = reg.installing;

          worker.addEventListener('statechange', function () {
            if (worker.state == 'redundant') {
              console.log('[*] Install failed');
            }
            if (worker.state == 'installed') {
              console.log('[*] Install successful!');
            }
            // (2)
            if (worker.state == 'activated' && !navigator.serviceWorker.controller) {
              console.log('[*] SW activated!');
            }
          });
        });
      }
    </script>

  </body>
</html>
