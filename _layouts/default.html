<!DOCTYPE html>
<html lang="en">
  <head>
    <title>{% if page.title %}{{ page.title }} – {% endif %}{{ site.name }} – {{ site.description }}</title>

    {% include scripts/meta.html %}

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    {% if page.canonical-url == nil %} 
      {% capture canonical %}
        {{ site.url }} 
        {% if site.permalink contains '.html' %}
          {{ page.url }}
        {% else %}
          {{ page.url | remove:'index.html' | strip_slash }}
        {% endif %}
      {% endcapture %}
    {% else %} 
      {% assign canonical = page.canonical-url %} 
    {% endif %}
    <link rel="canonical" href="{{ canonical }}">

    <script defer src="https://use.fontawesome.com/releases/v5.0.2/js/all.js"></script>
    <link rel="stylesheet" type="text/css" href='https://css.tito.io/v1.1' />
    <link rel="shortcut icon" type="image/x-icon" href="{{ site.baseurl }}/favicon.ico?">
    <link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/style.css?{{site.time | date: '%s%N'}}" />
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
    <link rel="alternate" type="application/rss+xml" title="{{ site.name }} - {{ site.description }}" href="{{ site.baseurl }}/feed.xml" />

    <script src="{{ site.baseurl }}/assets/js/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
      w[l] = w[l] || []; w[l].push({
        'gtm.start':
          new Date().getTime(), event: 'gtm.js'      
}); var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
          'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
      })(window, document, 'script', 'dataLayer', 'GTM-M9MJLPW');</script>
    <!-- End Google Tag Manager -->
  </head>

  <body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
      <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M9MJLPW" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div class="alert alert-info" role="alert">
      Prices increase in {% include components/countdown.html %} <strong><a href="{{ site.baseurl }}/tickets">Book now</a></strong>
    </div>

    <nav class="navbar navbar-expand-md navbar-dark fixed-top">
      <a href="{{ site.baseurl }}/" class="navbar-brand">
        <img src="{{ site.baseurl }}/images/UXDX-White-NoLogoText-NoText.svg"  width="30" height="30" alt="UXDX Conf 2018"/>
      </a>
      
      <a class="navbar-brand" href="{{ site.baseurl }}/">UXDX Conf 2018</a>

      {% assign conference = site.data.conferences | where: "id", page.conference %} 
      {% assign conference = conference[0] %}
      
      {% if conference.primary_menu[0].pages___buttons.size > 0 %}
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#uxdxNav" aria-controls="uxdxNav"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      {% else %}
        <div></div>
      {% endif %}

    
      <div class="collapse navbar-collapse" id="uxdxNav">
        <ul class="navbar-nav ml-auto">
          {% for page in conference.primary_menu[0].pages___buttons %}
          <li class="nav-item">
            {% if page.url_slug == 'tickets' %}
            <a class="btn btn-outline-light" href="{{ site.baseurl }}/{{page.url_slug}}">{{page.url_slug | capitalize}}</a>
            {% elsif page.url_slug %}
              {% if page.menu_title.size > 0 %}
                {% assign title = page.menu_title %}
              {% else %}
               {% assign title = page.url_slug | capitalize %}
              {% endif %}
              <a class="nav-link" href="{{ site.baseurl }}/{{page.url_slug}}">{{title}}</a>
            {% else %}
              <tito-button event="{{conference.tito_event}}" releases="{{page.tito_release}}">{{button.button_text}}</tito-button>
            {% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>
    </nav>
    
    <main role="main">
      {{ content }}
    </main>

    {% include components/footer.html %}


    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="{{ site.baseurl }}/assets/js/bootstrap.min.js"></script>
    {% include scripts/video-script.html %}
    {% include scripts/agenda_toggle.html %}
    
    <!-- <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase-messaging.js"></script> -->
    <!-- <script>
      // Initialize Firebase
      var config = {
        apiKey: "AIzaSyAP8fPFW7OFw1Da05Geiev5fIZfkdAZL8A",
        authDomain: "uxdxconf.firebaseapp.com",
        databaseURL: "https://uxdxconf.firebaseio.com",
        projectId: "uxdxconf",
        storageBucket: "uxdxconf.appspot.com",
        messagingSenderId: "576147997259"
      };
      firebase.initializeApp(config);
    </script>
    <script src="{{ site.baseurl }}/assets/js/auth.js"></script> -->
    
    <script type="text/javascript">

      // (1)
      if (navigator.serviceWorker) {
        navigator.serviceWorker.register('/service-worker.js').then(function (reg) {
          if (!reg.installing) return;
          console.log("[*] ServiceWorker is installing...");

          var worker = reg.installing;

          worker.addEventListener('statechange', function () {
            if (worker.state == 'redundant') {
              console.log('[*] Install failed');
            }
            if (worker.state == 'installed') {
              console.log('[*] Install successful!');
            }
            // (2)
            if (worker.state == 'activated' && !navigator.serviceWorker.controller) {
              console.log('[*] SW activated!');
            }
          });
        });
      }
    </script>

  </body>
</html>
